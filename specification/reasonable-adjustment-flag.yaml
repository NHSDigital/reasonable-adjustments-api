openapi: 3.0.0
info:
  version: 0.3.4-beta
  title: Reasonable Adjustment Flag API
  description: |
    ## Overview
    Use this API to access and update the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag#top) on the [NHS Spine](https://digital.nhs.uk/services/spine). 

    The flag indicates the need for services to be adjusted to meet the needs of patients with learning, physical or sensory disabilities, autism or other significant impairments such as dementia – as defined in the [Equality Act (2010)](https://www.legislation.gov.uk/ukpga/2010/15/contents). A reasonable adjustment flag can mean alterations to buildings, such as providing lifts, wide doors, ramps and tactile signage. It may also mean changes to policies, procedures and staff training to ensure that services work equally well for people with physical or sensory disabilities, learning disabilities or long-term conditions such as dementia.

    Other adjustments include longer appointments, providing easy read materials or communications via a carer. This legal duty is anticipatory, which means a service should know about a person’s need for adjustments when they are referred or when they present for care.

    This API is a key enabler to NHS Digital’s requirement to adhere to one of the 9 digital milestones within the [NHS Long Term Plan](https://www.longtermplan.nhs.uk/online-version/chapter-3-further-progress-on-care-quality-and-outcomes/a-strong-start-in-life-for-children-and-young-people/learning-disability-and-autism/), which states:

    **"By 2023/24, a ‘digital flag’ in the patient record will ensure staff know a patient has a learning disability or autism”.**

    Using this API, you can:
    - create, read, update and remove **impairments**, which enable clinicians to understand the range of adjustments the patient may require. **Note** the patient may decline to say what their impairments are
    - create, read, update and remove **adjustments** which are needed by the patient when providing their care
    - capture, view or update details of **consent** to record [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag#top) information and how this was obtained. Consent may have been given by the patient or via a 'best interest decision' under the [Mental Capacity Act (2005)](https://www.nhs.uk/conditions/social-care-and-support-guide/making-decisions-for-someone-else/mental-capacity-act/). In some cases consent can also be obtained from a lasting power of attorney for health and welfare or a court appointed deputy. 

    The presence of a flag is intended to be visible to all staff who have access to the patient record.  The contents of the flag may only be visible to clinical staff - as determined by Role Based Access Controls. For more information see [Registration authorities and smartcards](https://digital.nhs.uk/services/registration-authorities-and-smartcards).

    To find out more about how the flag works, categories and types of adjustments and the recording of impairments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).

    To watch a video of a Reasonable Adjustment Flag being created in [SCRa](https://digital.nhs.uk/services/summary-care-record-application) see [Creating a Reasonable Adjustment Flag on the NHS Spine](https://www.youtube.com/watch?v=dX-IwYXXEwE). 

    This API can only be accessed by relevant health and care staff providing direct care, authenticated with an NHS smartcard or equivalent.

    ## Legal Use
    This API can only be used where there is a legal basis to do so. Make sure you have a valid use case before you go too far with your development. You must do this before you can go live (see ‘Onboarding’ below).

    ## Related APIs
    To use this API, you will need the patient's NHS number, which can be retrieved by using the following API:

      - [Personal Demographics Service (FHIR) API](https://digital.nhs.uk/developer/api-catalogue/personal-demographics-service-fhir) - use this API to search for patients and retrieve their details.  This API can also be used to update their details in some cases. This is the latest version of the PDS API and is recommended for all new integrators.

     When using this API, we also recommend that you consider using these related APIs:

      - [Female Genital Mutilation Information Sharing System (FGM-IS)](https://developer.nhs.uk/apis/fgm-v2.1/) - use this API to store and share FGM information of children under 18 with relevant NHS healthcare professionals across departments, organisations and geographical boundaries within England.

      - [Child Protection Information Sharing (CP-IS) - HL7 V3 API](https://digital.nhs.uk/services/child-protection-information-sharing-project/cp-is-domain-message-specification) - use this messaging and interactions guide to provide access to CP-IS, a sharing system which provides healthcare workers with access to recent unscheduled care attendance information for children under a local authority social care plan. 

      - [National Record Locator (NRL) (FHIR) API](https://developer.nhs.uk/apis/nrl/) - use this API to locate and share patient records held within local health and social care systems.

    ## API Status and Roadmap
     This API is in [alpha](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#api-status) - expect further breaking changes.
     
     The API is currently available for sandbox testing, but not integration testing or for production use.
         
    To see our roadmap, or to suggest, comment or vote on features for this API, see our [interactive product backlog](https://nhs-digital-api-management.featureupvote.com/?order=popular&filter=all&tag=reasonable-adjustment-flag#controls).

    If you have any other queries, please [contact us](https://digital.nhs.uk/developer/help-and-support).

    ## Technology
    This API is [RESTful](https://digital.nhs.uk/developer/guides-and-documentation/api-technologies-at-nhs-digital#basic-rest-apis). 

    It also conforms to the [FHIR (STU3)](https://www.hl7.org/fhir/STU3/) global standard for health care data exchange.

    You don’t need to know much about FHIR to use this API - FHIR APIs are just RESTful APIs that follow specific rules. In particular:
    - array names are singular, for example `line` not `lines` for address lines
    - data items that are country-specific and thus not included in the FHIR global base resources are usually wrapped in an `extension` object

    ### Resources
    For information on the resources used within the Reasonable Adjustment Flag see [Reasonable Adjustment Flag FHIR specification](https://dev-reasonable-adjust-beta.netlify.app/explore.html).


    ## Network Access
    This API is available on the internet and, indirectly, on the [Health and Social Care Network (HSCN)](https://digital.nhs.uk/services/health-and-social-care-network). To use this API with NHS smartcards (see below) you do need an HSCN connection, although internet-facing alternatives are available.

    For more details see [Network access for APIs](https://digital.nhs.uk/developer/guides-and-documentation/network-access-for-apis).

    ## Authorisation
    This API is [user-restricted](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#user-restricted-apis), meaning an end user must be present and authenticated to use it.

    The end user must be:
    - a healthcare professional
    - strongly authenticated, using either an NHS smartcard or a modern alternative available via [NHS Identity](https://digital.nhs.uk/services/nhs-identity)

    The API uses OAuth 2.0 to authorise the calling system. It supports the following security patterns:

    - [user-restricted RESTful API - using NHS Identity - combined authentication and authorisation](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/user-restricted-restful-apis-nhs-identity-combined-authentication-and-authorisation)
    - [user-restricted RESTful API - using NHS Identity - separate authentication and authorisation](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/user-restricted-restful-apis-nhs-identity-separate-authentication-and-authorisation)

    For more details, see [user-restricted APIs](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#user-restricted-apis).


    ## Environments and testing
    | Purpose                                | Base URL                                 |
    | ---------------------------------------|------------------------------------------|
    | Sandbox                                | `https://sandbox.service.nhs.uk/reasonable-adjustment-flag`    |
    | Integration test **(available Nov 2020)**  | `https://int.service.nhs.uk/reasonable-adjustment-flag`        |
    | Production **(available Dec 2020/Jan 2021)** | `https://api.service.nhs.uk/reasonable-adjustment-flag`      |


    ### Sandbox testing
    Our [sandbox environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#sandbox-testing):
      - is for early developer testing
      - only covers a limited set of scenarios
      - is stateless, so it does not actually persist any updates
      - is open access, so does not allow you to test authorisation

      For more details on sandbox testing, or to try out the sandbox using our \"Try this API\" feature, see the documentation for each endpoint.

      Alternatively, you can try out the sandbox using our Postman collection:
    
      [![Run in Postman](https://run.pstmn.io/button.svg)](https://app.getpostman.com/run-collection/732bdc7fcb232c2825ac)

    ### Opentest testing
    Opentest is an open access test environment which is used as part of our onboarding process where you can test your application, generate evidence and validation reports.
    Access the Opentest environment through a VPN. You do not need to have an HSCN connection.

    Request access from [Platforms Support Desk](platforms.supportdesk@nhs.net), providing your contact details, what type of development you are interested in and any specific requirements, in this case ‘Reasonable Adjustment Flag’ testing.

    - you shall receive an email containing credentials for accessing Opentest with a ‘ovpn token’ which uses the [OpenVPN](https://openvpn.net/community-downloads-2/) software
    - the Reasonable Adjustment test harness is addressable on 192.168.128.21 using Mutual TLS (TLSMA) on port 443 or in the clear on 8080
            
    #### Our Opentest environment
    - is for early developer testing
    - provides list of supported test scenarios (available in next version)
    - is to trigger specific test scenarios based upon the NHS Number in the request
    - is to test conformance against happy path and exception scenarios
      
    While connected to the VPN, evidence and validation reports are accessible by logging into the [Opentest Portal](http://192.168.128.16/Login.aspx). You need  to request a login by contacting the [Platforms Support Desk](platforms.supportdesk@nhs.net), one or more email addresses can be registered for the portal.
            
    **NOTE** The Reasonable Adjustment test harness will automatically email you the validation reports when completed.
            Completion of the Opentest scenarios and submission of the evidence to the Assurance Team allows you to access the integration environment.

    ## Onboarding
    You need to get your software approved by us before it can go live with this API. We call this onboarding. The onboarding process can sometimes be quite long, so it’s worth planning well ahead.

    We will provide further details about how to onboard onto the API in December 2020.
  contact:
    name: API Management Support
    email: api.management@nhs.net
servers:
  - url: 'https://sandbox.api.service.nhs.uk/reasonable-adjustment-flag'
    description: Sandbox environment.
paths:
  /Flag:
    post:
      summary: Create a Flag resource
      description: |-
        ## Overview
        Use this endpoint to create a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) against the patient record on the [NHS Spine](https://digital.nhs.uk/services/spine). This will describe the adjustment that the patient needs and will either be a coded national adjustment as defined by [SNOMED CT](https://digital.nhs.uk/services/terminology-and-classifications/snomed-ct), or an adjustment which has been manually keyed by a clinician. To find out more about the different types of adjustments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).


        For full details of this API resource see [RARecord-Flag-1](https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1/_history/0.0.5).
      operationId: postFlag
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/code'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      requestBody:
        description: Create flag
        required: true
        content:
          application/fhir+json:
            schema:
              type: object
              properties:
                resourceType:
                  type: string
                  example: Flag
                fhir_comments:
                  type: array
                  items:
                    type: string
                    example: ' xml example fileAddExample-CreateFlagRequest.xml '
                meta:
                  type: object
                  properties:
                    profile:
                      type: array
                      items:
                        type: string
                        example: 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1'
                extension:
                  type: array
                  items:
                    type: object
                    properties:
                      url:
                        type: string
                        example: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-AdjustmentCategory-1'
                      valueCodeableConcept:
                        type: object
                        properties:
                          coding:
                            type: array
                            items:
                              type: object
                              properties:
                                system:
                                  type: string
                                  example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AdjustmentCategories-1'
                                code:
                                  type: string
                                  example: comms
                                display:
                                  type: string
                                  example: Communication
                status:
                  type: string
                  example: active
                category:
                  type: object
                  properties:
                    coding:
                      type: array
                      items:
                        type: object
                        properties:
                          system:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1'
                          code:
                            type: string
                            example: reasonable adjustment flag
                          display:
                            type: string
                            example: Reasonable Adjustment Flag
                code:
                  type: object
                  properties:
                    coding:
                      type: array
                      items:
                        type: object
                        properties:
                          system:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AccessibleInformationAdjustments-1'
                          code:
                            type: string
                            example: requiresinformationineasyread
                          display:
                            type: string
                            example: Requires information in Easyread
                subject:
                  type: object
                  properties:
                    reference:
                      type: string
                      example: demographics.spineservices.nhs.uk/STU3/Patient/999999998
            examples:
              success:
                value:
                  resourceType: Flag
                  fhir_comments:
                    - ' xml example fileAddExample-CreateFlagRequest.xml '
                  meta:
                    profile:
                      - 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1'
                  extension:
                    - url: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-AdjustmentCategory-1'
                      valueCodeableConcept:
                        coding:
                          - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AdjustmentCategories-1'
                            code: comms
                            display: Communication
                  status: active
                  category:
                    coding:
                      - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1'
                        code: reasonable adjustment flag
                        display: Reasonable Adjustment Flag
                  code:
                    coding:
                      - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AccessibleInformationAdjustments-1'
                        code: requiresinformationineasyread
                        display: Requires information in Easyread
                  subject:
                    reference: demographics.spineservices.nhs.uk/STU3/Patient/999999998
      responses:
        '201':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Last-Modified:
                    type: string
                    format: date-time
                    example: '2018-07-23T11:00:00+00:00'
                  Location:
                    type: string
                    example: null
                  ETag:
                    type: string
                    example: resourceVID
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n                  \n"
      tags:
        - Endpoints
    get:
      summary: Read a Flag resource
      description: |-
        ## Overview
        Use this endpoint to view a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) against the patient record on the [NHS Spine](https://digital.nhs.uk/services/spine). This will describe the adjustment that the patient needs and will either be a coded national adjustment as defined by [SNOMED CT](https://digital.nhs.uk/services/terminology-and-classifications/snomed-ct), or an adjustment which has been manually keyed by a clinician. To find out more about the different types of adjustments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).


        For full details of this API resource see [RARecord-Flag-1](https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1/_history/0.0.5).
      operationId: readFlag
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              schema:
                type: object
                description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\nSearch outcomes:\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| INVALID_SEARCH_DATA\t       | 400           | The search parameters are invalid. A description of what exactly is at fault will be added to the display. |\n| TOO_MANY_MATCHES           | 200           | Too many matches were found - user should be told to refine their search parameters.\t|\nUpdate outcomes:\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\nPolling outcomes\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
                properties:
                  resourceType:
                    type: string
                    description: FHIR Resource Type.
                    default: OperationOutcome
                    readOnly: true
                  issue:
                    type: array
                    description: List of issues that have occurred.
                    minItems: 1
                    items:
                      type: object
                      required:
                        - severity
                        - code
                      properties:
                        severity:
                          type: string
                          enum:
                            - fatal
                            - error
                            - warning
                            - information
                          description: Severity of the error.
                          example: error
                        code:
                          type: string
                          description: FHIR error code.
                          example: invalid
                          enum:
                            - invalid
                            - structure
                            - required
                            - value
                            - invariant
                            - security
                            - login
                            - unknown
                            - expired
                            - forbidden
                            - suppressed
                            - processing
                            - not-supported
                            - duplicate
                            - multiple-matches
                            - not-found
                            - deleted
                            - too-long
                            - code-invalid
                            - extension
                            - too-costly
                            - business-rule
                            - conflict
                            - transient
                            - lock-error
                            - no-store
                            - exception
                            - timeout
                            - incomplete
                            - throttled
                            - informational
                        details:
                          type: object
                          description: Internal error code.
                          properties:
                            coding:
                              type: array
                              items:
                                type: object
                                readOnly: true
                                properties:
                                  system:
                                    type: string
                                    description: URI of the coding system specification.
                                    example: 'https://fhir.nhs.uk/R4/CodeSystem/Spine-ErrorOrWarningCode'
                                  version:
                                    type: string
                                    description: Version of the coding system in use.
                                    example: '1'
                                  code:
                                    type: string
                                    description: Symbol in syntax defined by the system.
                                    example: INVALID_VALUE
                                  display:
                                    type: string
                                    description: Representation defined by the system.
                                    example: Provided value is invalid
                        diagnostics:
                          type: string
                          description: Additional diagnostic information about the issue.
                          example: Invalid value - 2019-01 in field 'birthDate'
                        expression:
                          type: string
                          description: FHIRPath of element(s) related to the error.
                          example: Patient.name.given
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
  '/Flag/{flagID}':
    put:
      summary: Update a Flag resource
      description: |-
        ## Overview
        Use this endpoint to update a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) against the patient record on the [NHS Spine](https://digital.nhs.uk/services/spine). This will describe the adjustment that the patient needs and will either be a coded national adjustment as defined by [SNOMED CT](https://digital.nhs.uk/services/terminology-and-classifications/snomed-ct), or an adjustment which has been manually keyed by a clinician. You can also use this endpoint to delete an existing adjustment. To find out more about the different types of adjustments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).


        For full details of this API resource see [RARecord-Flag-1](https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1/_history/0.0.5).
      operationId: updateFlag
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
        - $ref: '#/components/parameters/If-Match'
        - $ref: '#/components/parameters/flagID'
      requestBody:
        description: Update flag
        required: true
        content:
          application/fhir+json:
            schema:
              type: object
              properties:
                resourceType:
                  type: string
                  example: Flag
                id:
                  type: string
                  example: 2acb0536-0a8f-48c9-8a2f-6ee82860f186
                fhir_comments:
                  type: array
                  items:
                    type: string
                    example: ' xml example fileUpdateExample-UpdateFlagRequest.xml '
                meta:
                  type: object
                  properties:
                    versionId:
                      type: string
                      example: aa755bd6-2be9-4971-972a-6724879c5cb1
                    lastUpdated:
                      type: string
                      example: '2018-07-24T10:01:00+00:00'
                    profile:
                      type: array
                      items:
                        type: string
                        example: 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1'
                contained:
                  type: array
                  items:
                    type: object
                    properties:
                      resourceType:
                        type: string
                        example: Provenance
                      id:
                        type: string
                        example: 43124f67-b09d-453d-b889-a5e2e8780b9e
                      meta:
                        type: object
                        properties:
                          profile:
                            type: array
                            items:
                              type: string
                              example: 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Provenance-1'
                      target:
                        type: array
                        items:
                          type: object
                          properties:
                            reference:
                              type: string
                              example: Flag/2acb0536-0a8f-48c9-8a2f-6ee82860f186
                      recorded:
                        type: string
                        example: '2018-07-24T10:05:33+00:00'
                      agent:
                        type: array
                        items:
                          type: object
                          properties:
                            role:
                              type: array
                              items:
                                type: object
                                properties:
                                  coding:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        system:
                                          type: string
                                          example: 'https://fhir.nhs.uk/STU3/CodeSystem/CareConnect-SDSJobRoleName-1'
                                        code:
                                          type: string
                                          example: R1974
                                        display:
                                          type: string
                                          example: Community Learning Disabilities Nurse
                            whoReference:
                              type: object
                              properties:
                                reference:
                                  type: string
                                  example: 'https://sds.spineservices.nhs.uk/STU3/Practitioner/4tr6ee6a9'
                                display:
                                  type: string
                                  example: Nurse N
                            onBehalfOfResource:
                              type: object
                              properties:
                                reference:
                                  type: string
                                  example: 'https://directory.spineservices.nhs.uk/STU3/Organization/a3e5i7'
                                display:
                                  type: string
                                  example: Some Hospital Learning Disability Support Department
                extension:
                  type: array
                  items:
                    anyOf:
                      - type: object
                        properties:
                          url:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-Provenance-1'
                          extension:
                            type: array
                            items:
                              type: object
                              properties:
                                url:
                                  type: string
                                  example: created
                                valueReference:
                                  type: object
                                  properties:
                                    reference:
                                      type: string
                                      example: '#43124f67-b09d-453d-b889-a5e2e8780b9e'
                      - type: object
                        properties:
                          url:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-RemovalReason-1'
                          extension:
                            type: array
                            items:
                              anyOf:
                                - type: object
                                  properties:
                                    url:
                                      type: string
                                      example: removalReason
                                    valueCodeableConcept:
                                      type: object
                                      properties:
                                        coding:
                                          type: array
                                          items:
                                            type: object
                                            properties:
                                              system:
                                                type: string
                                                example: 'https://fhir.nhs.uk/STU3/CodeSystem/RARecord-RemovalReason-1'
                                              code:
                                                type: string
                                                example: Error
                                              display:
                                                type: string
                                                example: The Reasonable Adjustment Flag was created in error
                                - type: object
                                  properties:
                                    url:
                                      type: string
                                      example: supportingComment
                                    valueString:
                                      type: string
                                      example: Requires Large Print rather than Easy Read
                      - type: object
                        properties:
                          url:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-AdjustmentCategory-1'
                          valueCodeableConcept:
                            type: object
                            properties:
                              coding:
                                type: array
                                items:
                                  type: object
                                  properties:
                                    system:
                                      type: string
                                      example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AdjustmentCategories-1'
                                    code:
                                      type: string
                                      example: comms
                                    display:
                                      type: string
                                      example: Communication
                status:
                  type: string
                  example: inactive
                category:
                  type: object
                  properties:
                    coding:
                      type: array
                      items:
                        type: object
                        properties:
                          system:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1'
                          code:
                            type: string
                            example: reasonable adjustment flag
                          display:
                            type: string
                            example: Reasonable Adjustment Flag
                code:
                  type: object
                  properties:
                    coding:
                      type: array
                      items:
                        type: object
                        properties:
                          system:
                            type: string
                            example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AccessibleInformationAdjustments-1'
                          code:
                            type: string
                            example: requiresinformationineasyread
                          display:
                            type: string
                            example: Requires information in Easyread
                subject:
                  type: object
                  properties:
                    reference:
                      type: string
                      example: demographics.spineservices.nhs.uk/STU3/Patient/999999998
            examples:
              success:
                value:
                  resourceType: Flag
                  id: 2acb0536-0a8f-48c9-8a2f-6ee82860f186
                  fhir_comments:
                    - ' xml example fileUpdateExample-UpdateFlagRequest.xml '
                  meta:
                    versionId: aa755bd6-2be9-4971-972a-6724879c5cb1
                    lastUpdated: '2018-07-24T10:01:00+00:00'
                    profile:
                      - 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Flag-1'
                  contained:
                    - resourceType: Provenance
                      id: 43124f67-b09d-453d-b889-a5e2e8780b9e
                      meta:
                        profile:
                          - 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Provenance-1'
                      target:
                        - reference: Flag/2acb0536-0a8f-48c9-8a2f-6ee82860f186
                      recorded: '2018-07-24T10:05:33+00:00'
                      agent:
                        - role:
                            - coding:
                                - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CareConnect-SDSJobRoleName-1'
                                  code: R1974
                                  display: Community Learning Disabilities Nurse
                          whoReference:
                            reference: 'https://sds.spineservices.nhs.uk/STU3/Practitioner/4tr6ee6a9'
                            display: Nurse N
                          onBehalfOfReference:
                            reference: 'https://directory.spineservices.nhs.uk/STU3/Organization/a3e5i7'
                            display: Some Hospital Learning Disability Support Department
                  extension:
                    - url: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-Provenance-1'
                      extension:
                        - url: created
                          valueReference:
                            reference: '#43124f67-b09d-453d-b889-a5e2e8780b9e'
                    - url: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-RemovalReason-1'
                      extension:
                        - url: removalReason
                          valueCodeableConcept:
                            coding:
                              - system: 'https://fhir.nhs.uk/STU3/CodeSystem/RARecord-RemovalReason-1'
                                code: Error
                                display: The Reasonable Adjustment Flag was created in error
                        - url: supportingComment
                          valueString: Requires Large Print rather than Easy Read
                    - url: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-AdjustmentCategory-1'
                      valueCodeableConcept:
                        coding:
                          - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AdjustmentCategories-1'
                            code: comms
                            display: Communication
                  status: inactive
                  category:
                    coding:
                      - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1'
                        code: reasonable adjustment flag
                        display: Reasonable Adjustment Flag
                  code:
                    coding:
                      - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-AccessibleInformationAdjustments-1'
                        code: requiresinformationineasyread
                        display: Requires information in Easyread
                  subject:
                    reference: demographics.spineservices.nhs.uk/STU3/Patient/999999998
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Last-Modified:
                    type: string
                    format: date-time
                    example: '2018-07-23T11:00:00+00:00'
                  ETag:
                    type: string
                    example: resourceVID
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        '409':
          description: CONFLICT
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Content-Type:
                    type: string
                    example: application/fhir+json
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
  /List:
    post:
      summary: Create a List resource
      description: |-
        ## Overview
        Use this endpoint to create a list of impairments held within the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) stored on the [NHS Spine](https://digital.nhs.uk/services/spine). These impairments will likely have been captured during the discussion between the clinician and the patient or their carer. Patients may however decline to provide details of their impairments if they do not want to share them. To capture an impairment the member of staff selects an impairment type and then provides additional information using a free text field. For more details regards impairments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).

        For full details of this API resource see [CareConnect-RARecord-List-1](https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-RARecord-List-1)
      operationId: postList
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/code'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      requestBody:
        description: Create list
        required: true
        content:
          application/fhir+json:
            schema:
              type: object
              properties:
                resourceType:
                  type: string
                  example: Condition
                fhir_comments:
                  type: array
                  items:
                    type: string
                    example: ' json example AAJSONPlaceholder.json '
            examples:
              success:
                value:
                  resourceType: Condition
                  fhir_comments:
                    - ' json example AAJSONPlaceholder.json '
      responses:
        '201':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Last-Modified:
                    type: string
                    format: date-time
                    example: '2018-07-23T11:00:00+00:00'
                  Location:
                    type: string
                    example: null
                  ETag:
                    type: string
                    example: resourceVID
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
    get:
      summary: Read a List resource
      description: |-
        ## Overview
        Use this endpoint to read a list of impairments held within the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) information stored on the [NHS Spine](https://digital.nhs.uk/services/spine). These impairments will likely have been captured during the discussion between the clinician and the patient or their carer. Patients may however decline to provide details of their impairments if they do not want to share them. To capture an impairment the member of staff selects an impairment type and then provides additional information using a free text field. For more details regards impairments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).

        For full details of this API resource see [CareConnect-RARecord-List-1](https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-RARecord-List-1)
      operationId: readList
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/code'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
  '/List/{listID}':
    put:
      summary: Update a List resource
      description: |-
        ## Overview
        Use this endpoint to update a list of impairments held within the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) information held on the [NHS Spine](https://digital.nhs.uk/services/spine). These impairments will likely have been captured during the discussion between the clinician and the patient or their carer. Patients may however decline to provide details of their impairments if they do not want to share them. To capture an impairment the member of staff selects an impairment type and then provides additional information using a free text field. For more details regards impairments see [How the Reasonable Adjustment Flag works](https://digital.nhs.uk/services/reasonable-adjustment-flag#how-the-reasonable-adjustment-flag-works).

        For full details of this API resource see [CareConnect-RARecord-List-1](https://fhir.nhs.uk/STU3/StructureDefinition/CareConnect-RARecord-List-1)
      operationId: updateList
      requestBody:
        description: Update list
        required: true
        content:
          application/fhir+json:
            schema:
              type: object
              properties:
                resourceType:
                  type: string
                  example: Condition
                fhir_comments:
                  type: array
                  items:
                    type: string
                    example: ' json example AAJSONPlaceholder.json '
            examples:
              success:
                value:
                  resourceType: Condition
                  fhir_comments:
                    - ' json example AAJSONPlaceholder.json '
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/code'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
        - $ref: '#/components/parameters/If-Match'
        - $ref: '#/components/parameters/listID'
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Last-Modified:
                    type: string
                    format: date-time
                    example: '2018-07-23T11:00:00+00:00'
                  ETag:
                    type: string
                    example: resourceVID
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        '409':
          description: CONFLICT
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Content-Type:
                    type: string
                    example: application/fhir+json
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
  /Consent:
    post:
      summary: Create a Consent resource
      description: |-
        ## Overview
        Use this endpoint to record details regarding the patient's consent to share a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) record, as well as how this was obtained. Consent may have been given by the patient or via a 'best interest decision' under the [Mental Capacity Act (2005)](https://www.nhs.uk/conditions/social-care-and-support-guide/making-decisions-for-someone-else/mental-capacity-act/). In some cases consent can also be obtained from a lasting power of attorney for health and welfare, or a court appointed deputy. Consent is usually obtained by a suitable member of staff discussing the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) with the patient, their carer or the appropriate patient representative. The member of staff will then record the type of consent captured, along with some free text details providing more information about who provided the consent.

        For full details of this API resource see [RARecord-Consent-1](https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Consent-1)
      operationId: postConsent
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      requestBody:
        description: Create consent
        required: true
        content:
          application/fhir+json:
            schema:
              type: object
              properties:
                resourceType:
                  type: string
                  example: Consent
                fhir_comments:
                  type: array
                  items:
                    type: string
                    example: ' CreateExample-CreateConsentRequest.xml '
                meta:
                  type: object
                  properties:
                    profile:
                      type: array
                      items:
                        type: string
                        example: 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Consent-1'
                extension:
                  type: array
                  items:
                    type: object
                    properties:
                      url:
                        type: string
                        example: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-ProxyRole-1'
                      valueCodeableConcept:
                        type: object
                        properties:
                          coding:
                            type: array
                            items:
                              type: object
                              properties:
                                system:
                                  type: string
                                  example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-ProxyRole-1'
                                code:
                                  type: string
                                  example: lpa
                                display:
                                  type: string
                                  example: Lasting power of attorney personal welfare
                status:
                  type: string
                  example: active
                category:
                  type: array
                  items:
                    type: object
                    properties:
                      coding:
                        type: array
                        items:
                          type: object
                          properties:
                            system:
                              type: string
                              example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1'
                            code:
                              type: string
                              example: reasonable adjustments flag
                            display:
                              type: string
                              example: Reasonable Adjustments Flag
                patient:
                  type: object
                  properties:
                    reference:
                      type: string
                      example: demographics.spineservices.nhs.uk/STU3/Patient/999999998
                policy:
                  type: array
                  items:
                    type: object
                    properties:
                      authority:
                        type: string
                        example: 'https://www.gov.uk/'
                      uri:
                        type: string
                        example: 'https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/535024/data-security-review.pdf'
                purpose:
                  type: array
                  items:
                    type: object
                    properties:
                      system:
                        type: string
                        example: 'https://snomed.info/sct'
                      code:
                        type: string
                        example: '370856009'
                      display:
                        type: string
                        example: Limiting access to confidential patient information
            examples:
              success:
                value:
                  resourceType: Consent
                  fhir_comments:
                    - ' CreateExample-CreateConsentRequest.xml '
                  meta:
                    profile:
                      - 'https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Consent-1'
                  extension:
                    - url: 'https://fhir.nhs.uk/STU3/StructureDefinition/Extension-RARecord-ProxyRole-1'
                      valueCodeableConcept:
                        coding:
                          - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-ProxyRole-1'
                            code: lpa
                            display: Lasting power of attorney personal welfare
                  status: active
                  category:
                    - coding:
                        - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1'
                          code: reasonable adjustments flag
                          display: Reasonable Adjustments Flag
                  patient:
                    reference: demographics.spineservices.nhs.uk/STU3/Patient/999999998
                  policy:
                    - authority: 'https://www.gov.uk/'
                      uri: 'https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/535024/data-security-review.pdf'
                  purpose:
                    - system: 'https://snomed.info/sct'
                      code: '370856009'
                      display: Limiting access to confidential patient information
      responses:
        '201':
          description: Consent created.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Last-Modified:
                    type: string
                    format: date-time
                    example: '2018-07-23T11:00:00+00:00'
                  Location:
                    type: string
                    example: null
                  ETag:
                    type: string
                    example: resourceVID
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
    get:
      summary: Read a Consent resource
      description: |-
        ## Overview
        Use this endpoint to read details regarding the patient's consent to share a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) record, as well as how this was obtained. Consent may have been given by the patient or via a 'best interest decision' under the [Mental Capacity Act (2005)](https://www.nhs.uk/conditions/social-care-and-support-guide/making-decisions-for-someone-else/mental-capacity-act/). In some cases consent can also be obtained from a lasting power of attorney for health and welfare, or a court appointed deputy. Consent is usually obtained by a suitable member of staff discussing the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) with the patient, their carer or the appropriate patient representative. The member of staff will then record the type of consent captured, along with some free text details providing more information about who provided the consent.

        For full details of this API resource see [RARecord-Consent-1](https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Consent-1)
      operationId: readConsent
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
  '/Consent/{consentID}':
    put:
      summary: Update a Consent resource
      description: |-
        ## Overview
        Use this endpoint to update details regarding the patient's consent to share a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) record, as well as how this was obtained. Consent may have been given by the patient or via a 'best interest decision' under the [Mental Capacity Act (2005)](https://www.nhs.uk/conditions/social-care-and-support-guide/making-decisions-for-someone-else/mental-capacity-act/). In some cases consent can also be obtained from a lasting power of attorney for health and welfare, or a court appointed deputy. Consent is usually obtained by a suitable member of staff discussing the [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) with the patient, their carer or the appropriate patient representative. The member of staff will then record the type of consent captured, along with some free text details providing more information about who provided the consent.

        For full details of this API resource see [RARecord-Consent-1](https://fhir.nhs.uk/STU3/StructureDefinition/RARecord-Consent-1)
      operationId: updateConsent
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/status'
        - $ref: '#/components/parameters/category'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
        - $ref: '#/components/parameters/consentID'
      requestBody:
        description: Update record
        required: true
        content:
          application/fhir+json:
            schema:
              $ref: components/schemas/updateConsent.yaml
            examples:
              success:
                value:
                  $ref: components/examples/updateConsent.json
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Last-Modified:
                    type: string
                    format: date-time
                    example: '2018-07-23T11:00:00+00:00'
                  ETag:
                    type: string
                    example: resourceVID
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
  /$removerarecord:
    post:
      summary: Remove Reasonable Adjustment Flag Record
      description: |
        ## Overview
        Use this endpoint to remove a [Reasonable Adjustment Flag](https://digital.nhs.uk/services/reasonable-adjustment-flag) from the [NHS Spine](https://digital.nhs.uk/services/spine).  To remove a flag you must provide a reason for it being removed, for example the flag may have been created in error, or the flag may no longer apply to the patient. 

        For a patient it is represented as [CodeSystem-RARecord-RemovalReason-1](https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-RemovalReason-1). This triggers the system to inactivate all Reasonable Adjustment Flag resources contained within the patient record.
      operationId: removeRecord
      requestBody:
        description: Remove Reasonable Adjustment Flag record
        required: true
        content:
          application/fhir+json:
            schema:
              type: object
              description: A container for a remove RA record request.
              required:
                - resourceType
                - parameter
              properties:
                resourceType:
                  type: string
                  description: FHIR Resource type.
                  enum:
                    - Parameters
                  example: Parameters
                parameter:
                  type: array
                  description: A parameter in a bundle resource - will either contain a resource or information about a resource (transactions and history only).
                  items:
                    type: object
                    required:
                      - name
                      - part
                    properties:
                      name:
                        type: string
                        description: Name of parameter
                        example: removerarecord
                      part:
                        type: array
                        description: A list of parameters parts.
                        items:
                          anyOf:
                            - type: object
                              properties:
                                name:
                                  type: string
                                  example: nhsNumber
                                valueString:
                                  type: string
                                  example: '999999998'
                            - type: object
                              properties:
                                name:
                                  type: string
                                  example: removalReason
                                valueCodeableConcept:
                                  type: object
                                  properties:
                                    coding:
                                      type: array
                                      items:
                                        type: object
                                        properties:
                                          system:
                                            type: string
                                            example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-RemovalReason-1'
                                          code:
                                            type: string
                                            example: DoesntApply
                                          display:
                                            type: string
                                            example: The Reasonable Adjustment Flag no longer applies to the patient
                            - type: object
                              properties:
                                name:
                                  type: string
                                  example: supportingComment
                                valueString:
                                  type: string
                                  example: No longer applies
            examples:
              success:
                value:
                  resourceType: Parameters
                  parameter:
                    - name: removerarecord
                      part:
                        - name: nhsNumber
                          valueString: '999999998'
                        - name: removalReason
                          valueCodeableConcept:
                            coding:
                              - system: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-RemovalReason-1'
                                code: DoesntApply
                                display: The Reasonable Adjustment Flag no longer applies to the patient
                        - name: supportingComment
                          valueString: No longer applies
      parameters:
        - $ref: '#/components/parameters/patient'
        - $ref: '#/components/parameters/removalReason'
        - $ref: '#/components/parameters/supportingComment'
        - $ref: '#/components/parameters/BearerAuthorization'
        - $ref: '#/components/parameters/RoleId'
        - $ref: '#/components/parameters/CorrelationID'
        - $ref: '#/components/parameters/RequestID'
      responses:
        '200':
          description: Successful response.
          content:
            application/json:
              schema:
                type: object
                properties:
                  Date:
                    type: string
                    format: date-time
                    example: 'Tue, 23 Jul 2018 11:00:00 GMT'
                  Content-Type:
                    type: string
                    example: application/fhir+json
        '400':
          description: Invalid search parameters supplied.
          content:
            application/fhir+json:
              examples:
                invalid-nhsNumber:
                  summary: Invalid NHS Number for patient supplied.
                  value:
                    resourceType: OperationOutcome
                    issue:
                      - severity: error
                        code: value
                        details:
                          coding:
                            - system: 'https://fhir.nhs.uk/STU3/ValueSet/Spine-ErrorOrWarningCode-1'
                              code: INVALID_NHS_NUMBER
                              display: Invalid NHS number
        4XX:
          description: "Outcome of an operation that does not result in a resource or bundle being returned (e.g. error, async/batch submission).\nThere are a number of possible error codes that can be returned along with a more detailed description in the `display` field.\nThere are general outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| ACCESS_DENIED              | 401           | Used when the user does not have permission for a particular request. e.g. when their ASID does not have the correct interactions attached to it. |\n| FAILURE_TO_PROCESS_MESSAGE | 500           | A default message when something really bad has happened that the system could not handle.\t|\n| UNABLE_TO_CALL_SERVICE     | 408           | For a synchronous request, the downstream domain processing has not completed within the configured timeout period. |\n| UNSUPPORTED_SERVICE        | 400           | The service the user requested is an endpoint that does not exist - so is unsupported. e.g. /Patient/9999999999/Pets |\n| RESOURCE_NOT_FOUND         | 404           | The resource was not found. |\n| INVALID_RESOURCE_ID        | 400           | The resource ID was not valid. For example a NHS Number is presented which is not a valid NHS Number. |\n| INVALIDATED_RESOURCE       | 404           | The resource has been invalidated so could not be returned. |\n\nUpdate outcomes:\n\n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| PRECONDITION_FAILED        | 412           | Request missing basic requirements such as If-Match header (or invalid headers). |\n| RESOURCE_VERSION_MISMATCH  | 409           | The resource version has changed since your last read, so the update has been rejected. |\n| FORBIDDEN_UPDATE           | 403           | The user is not permitted to update certain resources or elements - a detailed description will be added to the display. For example - updating a sensitive patient or adding a formal death notification is only permitted from certain systems. |\n| VALIDATION_ERROR           | 400           | This it the \"default\" error thrown when no others are applicable. |\n| INVALID_UPDATE             | 400           | The update was invalid - a detailed description will be added to the display. |\n| MISSING_VALUE              | 400           | There was a missing value in the request. For example - a name update that is missing the surname. The missing value will be presented in the display.\t|\n| INVALID_VALUE              | 400           | There was an invalid value in the request. For example - a name update where the surname is too long. The invalid value and field will be presented in the display. |\n| UNSUPPORTED_VALUE          | 400           | There was an unsupported value in the request. The value may be valid in the schema - however it could be a legacy value that we do not allow to be set anymore. For example - setting the death notification status to 'removed'. The invalid value and field will be presented in the display. |\n| TOO_FEW_VALUES_SUBMITTED   | 400           | The field in question has a minimum number of items and the user sent too few. |\n| TOO_MANY_VALUES_SUBMITTED  | 400           | The field in question has a maximum number of items and the user sent too many. |\n| ADDITIONAL_PROPERTIES      | 400           | The user sent additional properties within the dictionary. For example sending a patient patch and attempting to add 'pets', which is not an allowed field within the patient resource. |\n\nPolling outcomes:\n  \n| Code                       | Response Code | Description                                   |\n| -------------------------- | ------------- | --------------------------------------------- |\n| POLLING_ID_NOT_FOUND       | 404           | When polling the ID was not found - or it was not applicable such as a non polling ID.\t|\n| POLLING_MESSAGE_FAILURE    | 422           | When polling an ID, a message was found to be in a failed state, so there is nothing else to be done and should be considered a failure. |\n"
      tags:
        - Endpoints
components:
  parameters:
    nhsNumber:
      name: nhsNumber
      in: query
      required: true
      description: ID number of a patient
      schema:
        type: object
        properties:
          name:
            type: string
            example: nhsNumber
          valueString:
            type: string
            example: '999999998'
    removalReason:
      name: removalReason
      in: query
      required: true
      description: Code recording Removal Reason
      schema:
        type: object
        properties:
          name:
            type: string
            example: removalReason
          valueCodeableConcept:
            type: object
            properties:
              coding:
                type: array
                items:
                  type: object
                  properties:
                    system:
                      type: string
                      example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-RemovalReason-1'
                    code:
                      type: string
                      example: DoesntApply
                    display:
                      type: string
                      example: The Reasonable Adjustment Flag no longer applies to the patient
    supportingComment:
      name: supportingComment
      in: query
      required: true
      description: Comment supporting Removal Reason
      schema:
        type: object
        properties:
          name:
            type: string
            example: supportingComment
          valueString:
            type: string
            example: No longer applies
    If-Match:
      name: If-Match
      in: header
      required: true
      description: Latest known version identifier enclosed in quotes preceded by `W/`.
      schema:
        type: string
        example: aa755bd6-2be9-4971-972a-6724879c5cb1
    consentID:
      name: consentID
      in: path
      required: true
      description: The id of the record
      schema:
        type: string
        example: '1'
    flagID:
      name: flagID
      in: path
      required: true
      description: The id of the flag
      schema:
        type: string
        example: '1'
    listID:
      name: listID
      in: path
      required: true
      description: The id of the list
      schema:
        type: string
        example: '1'
    patient:
      name: patient
      in: query
      required: true
      description: The id of the patient
      schema:
        type: string
        example: '9999999998'
    status:
      name: status
      in: query
      required: true
      description: status
      schema:
        type: string
        example: active
    category:
      name: category
      in: query
      required: true
      description: category
      schema:
        type: string
        example: 'https://fhir.nhs.uk/STU3/CodeSystem/CodeSystem-RARecord-FlagCategory-1|reasonable%20adjustments%20flag&_format=json'
    code:
      name: code
      in: query
      required: true
      description: code
      schema:
        type: string
        example: 'http://snomed.info/sct|1094391000000102&_format=json'
    RoleId:
      name: NHSD-Session-URID
      in: header
      required: false
      description: |
        A User Role ID (URID), also known as a User Role Profile ID (URPID), specifies the role the user is acting in.
        A URID belongs to a user (they are not generic) and a user may have more than one.
        Find out more about [User role ID](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/user-restricted-restful-apis-nhs-identity-combined-authentication-and-authorisation#step-6-determine-the-user-s-role)

        **Note: This parameter is required unless interacting with the Sandbox.**
      schema:
        type: string
        pattern: '^[0-9]+$'
        example: '555021935107'
    BearerAuthorization:
      name: Authorization
      in: header
      required: false
      description: |
        An [OAuth 2.0 bearer token](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#user-restricted-apis).

        **Note: This parameter is required unless interacting with the Sandbox.**
      schema:
        type: string
        format: '^Bearer\ [[:ascii:]]+$'
        example: 'Bearer g1112R_ccQ1Ebbb4gtHBP1aaaNM'
    CorrelationID:
      name: X-Correlation-ID
      in: header
      required: false
      description: |
        An identifier should be created when making a request, this will assist with any problems that may occur and should be included when an issue is raised with the helpdesk.
        It should ideally be a unique value to make message tracing easier and we would advise that there are no `"."` characters, but these are not enforced.
        This will be mirrored back in the response headers.
      schema:
        type: string
        example: 11C46F5F-CDEF-4865-94B2-0EE0EDCC26DA
    RequestID:
      name: X-Request-ID
      in: header
      required: false
      description: |
        A **globally unique identifier (GUID)** should be created when making a request, this will be used in message de-duplication, meaning if you need to replay any messages an identical response will be returned as the first time.
        The identifier must be a universally unique identifier (UUID) (ideally version 4).
        This will be mirrored back in the response headers.

        **Note: This parameter is required for `update`, `get` and `search` unless interacting with the Sandbox.**
      schema:
        type: string
        pattern: '^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$'
        example: 60E0B220-8136-4CA5-AE46-1D97EF59D068
        
  schemas:
    adjustmentCategoryExtension:
      $ref: components/schemas/adjustmentCategoryExtension.yaml
    createConsent:
      $ref: components/schemas/createConsent.yaml
    createFlag:
      $ref: components/schemas/createFlag.yaml
    createList:
      $ref: components/schemas/createList.yaml
    errorCode:
      $ref: components/schemas/errorCode.yaml
    flagRemovalReason:
      $ref: components/schemas/flagRemovalReason.yaml
    flagSupportingComment:
      $ref: components/schemas/flagSupportingComment.yaml
    nhsNumber:
      $ref: components/schemas/nhsNumber.yaml
    provenanceExtension:
      $ref: components/schemas/provenanceExtension.yaml
    removalReason:
      $ref: components/schemas/removalReason.yaml
    removalReasonExtension:
      $ref: components/schemas/removalReasonExtension.yaml
    removerarecord:
      $ref: components/schemas/removerarecord.yaml
    supportingComment:
      $ref: components/schemas/supportingComment.yaml
    updateFlag:
      $ref: components/schemas/updateFlag.yaml
    updateList:
      $ref: components/schemas/updateList.yaml
tags:
  - name: Reasonable Adjustment Flag
